<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Complete CCG Game Index</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script>
        /* ==========================================================
           UNIVERSAL BASE PATH â€” AUTO-DETECT DOMAIN
           Works on:
           - GitHub Pages
           - www.cheekycommodoregamer.co.uk
           - ANY future hosting
        ========================================================== */
        const BASE = window.location.origin + "/ccgamer_website_new/";
    </script>

    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #07101f;
            color: #e6f1ff;
            font-family: Arial, sans-serif;
        }

        h1 {
            text-align: center;
            color: #00eaff;
            margin-bottom: 20px;
        }

        #search-bar {
            width: 100%;
            max-width: 420px;
            margin: 0 auto 20px auto;
            display: block;
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid #1aaaff;
            background: rgba(0, 10, 20, 0.4);
            color: #e6f1ff;
            font-size: 16px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
            gap: 16px;
            padding: 10px 0;
        }

        .item {
            background: #0a1528;
            border: 1px solid #0d2e5c;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }

        .item img {
            width: 100%;
            height: 125px;
            object-fit: cover;
            border-radius: 4px;
        }

        .item a {
            display: block;
            margin-top: 6px;
            color: #9dd7ff;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .item a:hover {
            color: #00eaff;
        }
    </style>
</head>
<body>

<h1>Complete CCG Game Index</h1>

<input id="search-bar" type="text" placeholder="Search games...">

<div id="results" class="grid"></div>

<script>
    async function loadIndex() {
        try {
            const response = await fetch(BASE + "games/games.json");
            const games = await response.json();

            // Sort alphabetically
            games.sort((a, b) => a.title.localeCompare(b.title));

            const container = document.getElementById("results");
            container.innerHTML = "";

            games.forEach(game => {
                const card = document.createElement("div");
                card.className = "item";

                // Thumbnail
                const img = document.createElement("img");
                img.src = BASE + game.thumbnail;
                img.alt = game.title;

                // Title link
                const link = document.createElement("a");
                link.href = BASE + "games/game.html?id=" + encodeURIComponent(game.id);
                link.textContent = game.title;

                card.appendChild(img);
                card.appendChild(link);
                container.appendChild(card);
            });

            // Enable search
            document.getElementById("search-bar").addEventListener("input", function () {
                const q = this.value.toLowerCase();

                Array.from(document.querySelectorAll(".item")).forEach(item => {
                    const title = item.querySelector("a").textContent.toLowerCase();
                    item.style.display = title.includes(q) ? "block" : "none";
                });
            });

        } catch (err) {
            console.error("Error loading complete index:", err);
        }
    }

    loadIndex();
</script>

</body>
</html>
