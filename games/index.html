<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Genres</title>

    <!-- Boot logic (auto-disabled for this folder) -->
    <script defer src="../js/engine.js"></script>
    <script defer src="load-genre.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 1rem;
        }
        h1 {
            margin-bottom: 1rem;
        }
        .genre-item {
            margin-bottom: 0.75rem;
            font-size: 1.2rem;
        }
    </style>

    <script>
        async function buildGenreIndex() {
            const list = document.getElementById("genre-list");

            try {
                // Load full games JSON
                const response = await fetch("games.json");
                const data = await response.json();

                // Collect ALL genres from ALL games
                const allGenres = new Set();

                data.forEach(game => {
                    if (Array.isArray(game.genres)) {
                        game.genres.forEach(g => allGenres.add(g));
                    }
                });

                // Convert to sorted array
                const sortedGenres = Array.from(allGenres).sort();

                // Generate link slugs from genre names
                sortedGenres.forEach(genre => {
                    const slug = genre.toLowerCase()
                        .replace(/[^a-z0-9]+/g, "-")
                        .replace(/-+$/,"");

                    // Create entry
                    const div = document.createElement("div");
                    div.className = "genre-item";

                    div.innerHTML = `<a href="genres/${slug}.html">${genre}</a>`;
                    list.appendChild(div);
                });

            } catch (err) {
                console.error("Failed to build genre index:", err);
                list.textContent = "Error loading genre list.";
            }
        }

        document.addEventListener("DOMContentLoaded", buildGenreIndex);
    </script>
</head>

<body>
    <h1>All Game Genres</h1>
    <div id="genre-list">Loadingâ€¦</div>
</body>
</html>
